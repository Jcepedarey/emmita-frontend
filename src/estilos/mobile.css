/* ⚠️ Importante: aquí NO ponemos @tailwind base/components/utilities para evitar duplicados.
   Este archivo se procesa por Tailwind, así que puedes usar @apply sin problema. */

/* Solo móviles y tablets */
@media (max-width: 768px) {
  /* 🔹 Base tipográfica, fondo y SIN scroll horizontal (evita “zoom” y corrimientos) */
  html, body {
    background: var(--md-bg);
    color: var(--md-text);
    font-size: 15px;
    line-height: 1.45;
    -webkit-tap-highlight-color: transparent;
    overflow-x: hidden; /* clave para que el navegador no “aleje” la vista */
  }

  /* Espaciado lateral cómodo en vistas de página */
  .container, .contenedor, .page { @apply px-4; }

  /* 🔹 Escala tipográfica compacta */
  h1 { font-size: clamp(20px, 5vw, 24px); line-height: 1.2; }
  h2 { font-size: clamp(18px, 4.5vw, 22px); line-height: 1.25; }
  h3 { font-size: clamp(16px, 4vw, 20px); line-height: 1.3; }
  p, li { line-height: 1.45; }

  /* 🔹 Formularios más compactos y legibles (incluye Login) */
  input, select, textarea { @apply text-sm py-2; }
  label { @apply text-xs text-gray-600; }
  .form-row { @apply grid grid-cols-1 gap-3; } /* fuerza 1 columna en móvil */
  /* Login / auth centrado y con ancho controlado */
  .auth { max-width: 420px; margin: 0 auto; padding: 0 16px; }

  /* 🔹 Botones con target táctil adecuado */
  button { @apply text-sm px-3 py-2 rounded-lg; min-height: 40px; }

  /* 🔹 Tarjetas/controles (look Material compacto) */
  .card, .tarjeta {
    @apply bg-white rounded-lg border border-gray-200;
    padding: 12px;
    gap: 8px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
  }

  /* 🔹 Barra superior (app bar) sticky con blur sutil */
  .toolbar, .appbar, header.sticky, .encabezado {
    position: sticky;
    top: 0;
    z-index: 40;
    background: var(--md-surface);
    border-bottom: 1px solid var(--md-border);
    backdrop-filter: saturate(180%) blur(8px);
  }

  /* 🔹 Ocultar la barra flotante de navegación (flechas + home) en móvil */
  .nav-floating { display: none !important; }

  /* 🔹 Quitar la barra inferior que no te gustó */
  .menu-inferior { display: none !important; }

  /* 🔹 FAB de IA fijo: pegado al borde, respetando áreas seguras y SIN empujar el layout */
  .boton-ia {
    position: fixed;
    right: max(16px, env(safe-area-inset-right));
    bottom: max(16px, calc(env(safe-area-inset-bottom) + 16px));
    background: var(--md-secondary); /* morado */
    color: #ffffff;
    border: 0;
    border-radius: 9999px;
    padding: 10px 14px;
    font-size: 14px;
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
    z-index: 60;
    /* Evita que “afecte” el ancho del documento y cause overflow/zoom */
    contain: layout paint;
    isolation: isolate;
    max-width: calc(100vw - 32px);
    touch-action: manipulation;
  }

  /* 🔹 Ocultar sidebar y ampliar contenido en móvil */
  .sidebar, .aside, .panel-lateral { display: none !important; }
  main, .contenido, .main { width: 100% !important; }

  /* 🔹 Grids a 1 columna (si usas utilidades o clases personalizadas) */
  .grid.cols-2, .grid.cols-3, .grid.cols-4,
  .grid-cols-2, .grid-cols-3, .grid-cols-4 {
    grid-template-columns: 1fr !important;
  }

  /* 🔹 Cuadrícula de inicio compacta: 3 columnas solo en móvil */
  .menu-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
    padding: 0 8px;
  }
  .menu-grid .boton-modulo {
    padding: 10px;
    border-radius: 12px;
    border: 1px solid var(--md-border);
    background: #fff;
    box-shadow: 0 1px 2px rgba(0,0,0,.05);
    text-align: center;
  }
  .menu-grid .boton-modulo img { width: 44px; height: 44px; }
  .menu-grid .boton-modulo p { font-size: 13px; line-height: 1.15; margin-top: 6px; }

  /* 🔹 Tablas desplazables horizontalmente (sin romper layout) */
  table {
    display: block;
    width: 100%;
    overflow-x: auto;
    white-space: nowrap;
    border-spacing: 0;
  }
  th, td { padding: 8px 12px; }

  /* 🔹 Modal pantalla completa en móvil */
  .modal, .dialog {
    width: 100vw !important;
    max-width: 100vw !important;
    height: 100dvh !important;
    max-height: 100dvh !important;
    margin: 0 !important;
    border-radius: 0 !important;
  }

  /* 🔹 Helpers */
  .touch-target { min-height: 44px; min-width: 44px; } /* accesibilidad */
  .compact-y > * + * { margin-top: 8px; }
  .desktop-only { display: none !important; }
  .mobile-only { display: initial !important; }
}

/* 🌙 Modo oscuro (solo móvil) */
@media (max-width: 768px) and (prefers-color-scheme: dark) {
  html, body { background: #0b1220; color: #e5e7eb; }
  .card, .tarjeta { background: #0f172a; border-color: #1f2937; box-shadow: none; }
  .toolbar, .appbar, header.sticky, .encabezado {
    background: rgba(15, 23, 42, 0.85);
    border-bottom-color: #1f2937;
    backdrop-filter: saturate(180%) blur(10px);
  }
  /* La barra inferior está oculta en móvil, no se estiliza. */
  .boton-ia { background: #7c3aed; color: #fff; }
  input, select, textarea {
    @apply bg-slate-900 text-slate-100 border-slate-700 focus:ring-blue-500;
  }
  button {
    @apply bg-slate-800 text-slate-100 border-slate-700 hover:bg-slate-700;
  }
}
